{% extends './usuario/usuario.html' %}
{% block title %} Mis compras {% endblock %}
{% block cuerpo %}

<div class="Mostrar compras" style="min-width: 100%; height: 350px;">
    <div class="tabla_u">
        <table style="background-color: white; margin-left: 10%;">
            <thead>
                <tr>
                    <th>ID Compra</th>
                    <th>Publicaci√≥n</th>
                    <th>Comprador</th>
                    <th>Estado de Compra</th>
                    <th>Vendedor</th>
                    <th>Estado de Compra</th>
                    <th>Cambiar estado</th>
                </tr>
            </thead>
            <tbody>
                {% for compra in compras %}
                <tr>
                    <td>{{ compra['id_compra'] }}</td>
                    <td>{{ compra['nombre_publicacion'] }}</td>
                    <td>{{ compra['nombre_comprador'] }}</td>
                    <td>{{ compra['estado_compra'] }}</td>
                    <td>{{ compra['nombre_vendedor'] }}</td>
                    <td>{% for ultimo in ultimos %}
                        {{ ultimo['estados_compra'] }}
                        {% endfor %}</td>
                    <td>
                        <form action="{{ url_for('confirmar_compra', id_compra=compra.id_compra) }}" method="POST">
                            <div style="display: flex;">
                                <div>
                                    <select class="btn" style="width: 95%; border: solid 1px #3a6317;" id="estado" name="estado">
                                        <option value="" disabled selected hidden>Seleccione</option>
                                        {% for estado in estados %}
                                        <option value="{{estado.id_estados}}">{{ estado.nombre_estados }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div>
                                    <button type="submit" class="btn" style=" border: solid 1px #3a6317;">Cambiar estado</button>
                                </div>
                            </div>
                        </form>
                    </td>
                    {% endfor %}
                </tr>
            </tbody>
        </table>
    </div>
</div>

{% with messages = get_flashed_messages() %}
    {% if messages %}
    {% for message in messages %}

    <div class="alert alert-warning alert-dismissible fade show" role="alert"
        style="margin-left: 6%; margin-right: 6%; margin-bottom: 3%;">
        <p>{{ message }}</p>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}
{% endblock %}


